## 現在動作しているもの
- **[NEW] 口腔機能検査データの型変換・判定ロジックを全面見直し。スコア・測定値はnumber型で保持し、型不整合・丸め・判定ズレを根本解消。全画面でDB値と完全一致するよう統一。**
- **[NEW] OralFunctionExamData型をstring→number | undefined型に修正。全データ変換部（app/patients/[patientId]/page.tsx, app/patients/page.tsx, components/ExaminationDetailClient.tsx）でスコア・測定値をnumber型で渡すよう統一。**
- **[NEW] toResultStruct共通化により、全画面でsupabase値→同一出力・同一判定・同一表示・同一日付が保証されるようになった。**
- **[NEW] 印刷ページ・詳細ページ・n/7表示など全ての画面でtoResultStructのみを使うよう統一。舌苔の付着程度（TCI%）や計測日も正しく表示されるよう修正。**
- （従来の動作確認済み機能も維持）

## 今後実装すべきもの
- **身体機能評価詳細ページのさらなるUX改善・バリデーション強化・印刷連携・他画面再利用性の向上**
- **他画面・他用途への判定ロジック再利用、判定基準の柔軟な拡張、UI/UX仕様のさらなる最適化**
- **患者編集画面の更なるUX改善・バリデーション強化・エラーハンドリングの拡充**
- 管理計画書作成ページのさらなるUX改善・バリデーション・保存/プレビュー連携
- 口腔機能管理計画セクションのUIリファイン・保存機能
- 必要に応じてAPI連携・保存・印刷連携の強化
- 他セクションのUI/UX最適化
- ドキュメント・学びの随時反映

## 現在のステータス
- **[NEW] 口腔機能検査データの型変換・判定ロジックのnumber型統一により、全画面でDB値と完全一致する正確な判定・表示が実現**
- （従来の安定動作状況も維持）

## 既知の課題・懸念点
- **身体機能評価詳細ページのバリデーション・UX改善・印刷連携強化**
- **患者編集画面のバリデーション・UX改善・エラーハンドリング強化**
- **患者基本情報フォームのカルテ番号（karte_no）バリデーション・UI/UX最適化**
- 管理計画書作成ページのバリデーション・保存/プレビュー連携
- 口腔機能管理計画セクションのさらなるUX改善
- API連携・保存・印刷連携の強化
- 他セクションのUI/UX最適化
- **Supabaseデータ取得時のID不一致・データ欠損時のエラー検知・デバッグパターンの徹底**

## プロジェクト意思決定の変遷
- **[NEW] OralFunctionExamData型・データ変換・判定ロジックのnumber型統一パターンを確立。今後の拡張・他画面再利用も容易。**
- **[NEW] 型不整合や意図しない丸め・判定ズレが発生しない設計を全画面で統一。**
- **[NEW] supabaseから同じ値を取得した場合、全ての画面でtoResultStructを通じて同じ出力・同じ判定・同じ日付表示になることを保証。**
- （従来の意思決定も維持）
